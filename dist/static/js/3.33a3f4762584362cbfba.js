webpackJsonp([3],{K49x:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("mtWM"),n=i.n(a),o=i("HJfm"),s={data:function(){return{options:[],valueId:"",fileDescription:"",tableData:[{date:"2016-05-02",content:"上海市普陀区金沙江路 1518 弄"}],pageSize:10,total:0,pageNum:1,dialogVisible:!1,description:"",prefixName:""}},created:function(){var e=window.localStorage;this.authorization=e.getItem("userId"),this.token=e.getItem("token")},methods:{getLabels:function(){var e=this;n()({url:o.b+"/file/getLabels",method:"get",headers:{Authorization:"user-"+this.authorization+"-"+this.token}}).then(function(t){t.data.msg?e.$router.push({name:"login"}):e.options=t.data}).catch(function(e){console.log(e)})},uploadSuccess:function(e,t,i){this.$message({message:e,type:"success"}),this.getFiles(),this.$refs.upload.clearFiles(),this.valueId="",this.fileDescription=""},uploadError:function(e,t,i){this.$message.error("文件上传失败！")},beforeUpload:function(){if(""==this.cvalueId)return this.$message({message:"文件ID或文件描述不能为空！",type:"warning"}),!1},getFiles:function(){var e=this;n()({url:o.b+"/file/getFiles",method:"get",headers:{Authorization:"user-"+this.authorization+"-"+this.token},params:{pageSize:this.pageSize,pageNum:this.pageNum-1}}).then(function(t){t.data.msg?e.$router.push({name:"login"}):(e.total=t.data.count,e.tableData=t.data.list)}).catch(function(e){console.log(e)})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pageNum=e,this.getFiles(e)},handleDelete:function(e,t){var i=this;console.log(e,t),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n()({url:o.b+"/file/delFile",method:"get",headers:{Authorization:"user-"+i.authorization+"-"+i.token},params:{prefixName:t.prefixName,fileName:t.fileName}}).then(function(e){e.data.msg?i.$router.push({name:"login"}):(i.$message({message:"更新"+e.data.code+"条！",type:"success"}),i.getFiles())}).catch(function(e){console.log(e)})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},handleEdit:function(e,t){this.dialogVisible=!0,this.description=t.description,this.prefixName=t.prefixName},confirmRevision:function(){var e=this;n()({url:o.b+"/file/updateDescription",method:"get",headers:{Authorization:"user-"+this.authorization+"-"+this.token},params:{prefixName:this.prefixName,description:this.description}}).then(function(t){t.data.msg?e.$router.push({name:"login"}):(e.$message({message:"更新"+t.data.code+"条！",type:"success"}),e.description="",e.getFiles())}).catch(function(e){console.log(e)}),this.dialogVisible=!1},cancelRevision:function(){this.dialogVisible=!1},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})}},filters:{conversionBits:function(e){return e?e.toFixed(2):""}},computed:{myData:function(){return{prefixName:this.valueId,description:this.fileDescription}},myHeader:function(){return{Authorization:"user-"+this.authorization+"-"+this.token}}},mounted:function(){this.getLabels(),this.getFiles()}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fileUpload"},[i("h2",[e._v("文件上传")]),e._v(" "),i("div",{staticClass:"upload-dv"},[i("ul",[i("li",[e._v("\n                文件ID:\n                "),i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.valueId,callback:function(t){e.valueId=t},expression:"valueId"}},e._l(e.options,function(e){return i("el-option",{key:e.prefixName,attrs:{label:e.id,value:e.prefixName}})}),1)],1),e._v(" "),i("li",[e._v("\n                文件描述：\n                "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.fileDescription,expression:"fileDescription"}],attrs:{type:"text",placeholder:"请输入文件描述"},domProps:{value:e.fileDescription},on:{input:function(t){t.target.composing||(e.fileDescription=t.target.value)}}})])])]),e._v(" "),i("div",{staticClass:"upload-dv"},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"https://betaj.ssymmetry.com/backStageManagement/file/upload",data:e.myData,headers:e.myHeader,"on-success":e.uploadSuccess,"on-error":e.uploadError,"before-upload":e.beforeUpload,multiple:""}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击选择文件")])])])],1),e._v(" "),i("div",{staticClass:"upload-dv"},[i("div",[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[i("el-table-column",{attrs:{prop:"id",width:"120",align:"center",label:"文件ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"fileName",align:"center",label:"文件名"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"文件描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.description?i("span",[e._v(e._s(t.row.description))]):i("span",[e._v("——")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"updateTime",width:"140",align:"center",label:"更新日期"}}),e._v(" "),i("el-table-column",{attrs:{width:"120",align:"center",label:"文件大小"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("conversionBits")(t.row.size)))]),e._v(" MB\n                ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"编辑文件描述",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],staticStyle:{border:"1px solid #DCDFE6","border-radius":"4px","line-height":"40px",width:"95%"},attrs:{type:"text"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.cancelRevision()}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmRevision()}}},[e._v("确 定")])],1)])],1),e._v(" "),i("div",{staticClass:"pagination-dv"},[i("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1)])},staticRenderFns:[]};var r=i("VU/8")(s,l,!1,function(e){i("oKHK"),i("cPmc")},"data-v-90f4ecae",null);t.default=r.exports},cPmc:function(e,t){},oKHK:function(e,t){}});
//# sourceMappingURL=3.33a3f4762584362cbfba.js.map