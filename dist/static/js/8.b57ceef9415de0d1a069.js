webpackJsonp([8],{Gfr8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mtWM"),i=a.n(s),o=a("HJfm"),r={data:function(){return{selectedPermission:[],getPermissionses:{},updateSelectedPermission:[],allPermission:{},data2:[],defaultProps:{children:"children",label:"label"},accountType:[{value:"1",label:"国内量化基金"},{value:"2",label:"海外量化基金"},{value:"3",label:"国内基本面基金"},{value:"4",label:"海外基本面基金"},{value:"5",label:"其他"}],accountStatus:[{value:"0",label:"使用中"},{value:"-1",label:"已停用"}],value1:"",value2:"",modifyStatus:"",username:"",password:"",name:"",companyName:"",mobile:"",modify:{},modifyId:"",remake:"",authorization:"",token:"",days:""}},created:function(){var e=window.localStorage;this.authorization=e.getItem("userId"),this.token=e.getItem("token")},mounted:function(){"add"!=this.$route.params.key?(console.log("查123",this.$route.params.row),this.modify=this.$route.params.row,this.password="******",this.name=this.modify.name,this.companyName=this.modify.companyName,this.mobile=this.modify.mobile,this.value1=this.modify.type,this.value2=this.modify.status,"使用中"==this.modify.status?this.value2="0":"已停用"==this.modify.status&&(this.value2=" -1"),this.modifyId=this.modify.id,this.username=this.modify.username,this.remake=this.modify.remake,this.allPermission=this.modify.permissions,this.data2=this.formatData(this.modify.permissions),this.days=this.modify.days):this.getPermissions()},methods:{modifyUser:function(){var e=this;this.getCheckedNodes(),i()({url:o.b+"/apiPermission/insertOrUpdateApiUser",method:"post",headers:{Authorization:"user-"+this.authorization+"-"+this.token},data:{name:this.name,status:this.value2,type:this.value1,mobile:this.mobile,companyName:this.companyName,days:this.days,remake:this.remake,permissions:this.allPermission,id:this.modifyId}}).then(function(t){t.data.msg?e.$router.push({name:"login"}):(e.$router.push({name:"apiUser"}),e.$message({type:"success",message:"更新"+t.data.code+"条！"}))}).catch(function(e){console.log(e)})},addUser:function(){var e=this;if(this.getCheckedNodes(),this.password.length<6||this.password.length>20)return this.$message({message:"密码长度为6-20位!",type:"warning"}),!1;i()({url:o.b+"/apiPermission/insertOrUpdateApiUser",method:"post",headers:{Authorization:"user-"+this.authorization+"-"+this.token},data:{username:this.username,password:this.password,name:this.name,status:0,mobile:this.mobile,companyName:this.companyName,days:this.days,remake:this.remake,permissions:this.allPermission}}).then(function(t){t.data.msg?e.$router.push({name:"login"}):(e.$router.push({name:"apiUser"}),e.$message({type:"success",message:"更新"+t.data.code+"条！"}))}).catch(function(e){console.log(e)})},goBack:function(){this.$router.go(-1)},formatData:function(e){var t=this,a=[],s=0,i=function(i){var o={id:s+=1,label:i,children:[]};e[i].forEach(function(e){"unlock"==e.state&&t.selectedPermission.push(e.id),o.children.push({id:e.id,label:e.name});for(var a=0;a<e.length;a++);}),a.push(o)};for(var o in e)i(o);return a},getPermissions:function(){var e=this;i()({url:o.b+"/apiPermission/getPermissions",method:"get",headers:{Authorization:"user-"+this.authorization+"-"+this.token}}).then(function(t){t.data.msg?e.$router.push({name:"login"}):(e.allPermission=t.data,e.data2=e.formatData(t.data))}).catch(function(e){console.log(e)})},getCheckedNodes:function(){this.updateSelectedPermission=this.$refs.tree.getCheckedNodes();for(var e=[],t=0;t<this.updateSelectedPermission.length;t++){var a=this.updateSelectedPermission[t].id;this.updateSelectedPermission[t].label;for(var s in this.allPermission)for(var i=this.allPermission[s],o=0;o<i.length;o++)if(i[o].id==a)i[o].state="unlock",e.push(a);else{var r=!1;for(var n in e)e[n].indexOf(i[o].id)>-1&&(r=!0);r||(i[o].state="lock")}}}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addApiUser"},[a("div",{staticClass:"bx"},["add"==this.$route.params.key?a("h2",[e._v("新增账号")]):e._e(),e._v(" "),"modify"==this.$route.params.key?a("h2",[e._v("修改账号")]):e._e(),e._v(" "),"look"==this.$route.params.key?a("h2",[e._v("查看信息")]):e._e(),e._v(" "),a("div",{staticClass:"ul-div"},[a("ul",[a("li",[a("span",[e._v("用户名")]),e._v(" "),"add"==this.$route.params.key?a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}):e._e(),e._v(" "),"modify"==this.$route.params.key?a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",disabled:""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}):e._e(),e._v(" "),"look"==this.$route.params.key?a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",disabled:""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}):e._e()]),e._v(" "),a("li",[a("span",[e._v("密码")]),e._v(" "),"add"==this.$route.params.key?a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"text"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}):e._e(),e._v(" "),"modify"==this.$route.params.key?a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"text",disabled:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}):e._e(),e._v(" "),"look"==this.$route.params.key?a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"text",disabled:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}):e._e()]),e._v(" "),a("li",[a("span",[e._v("姓名")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),e._v(" "),a("li",[a("span",[e._v("所属公司")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.companyName,expression:"companyName"}],attrs:{type:"text"},domProps:{value:e.companyName},on:{input:function(t){t.target.composing||(e.companyName=t.target.value)}}})]),e._v(" "),a("li",[a("span",[e._v("联系电话")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.mobile,expression:"mobile"}],attrs:{type:"text"},domProps:{value:e.mobile},on:{input:function(t){t.target.composing||(e.mobile=t.target.value)}}})]),e._v(" "),a("li",[a("span",[e._v("API权限")]),e._v(" "),a("i",{staticClass:"permission-specification"},[a("el-tree",{ref:"tree",attrs:{data:e.data2,"show-checkbox":"","node-key":"id","default-expanded-keys":[1,2,3,4],"default-checked-keys":e.selectedPermission,props:e.defaultProps}})],1)]),e._v(" "),a("li",[a("span",[e._v("账号状态")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.accountStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("li",[a("span",[e._v("权限有效期")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.days,expression:"days"}],attrs:{type:"text"},domProps:{value:e.days},on:{input:function(t){t.target.composing||(e.days=t.target.value)}}}),e._v(" "),a("i",[e._v("天")])]),e._v(" "),a("li",[a("span",[e._v("备注信息")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.remake,expression:"remake"}],attrs:{type:"text"},domProps:{value:e.remake},on:{input:function(t){t.target.composing||(e.remake=t.target.value)}}})])])]),e._v(" "),a("div",{staticClass:"btns"},["add"==this.$route.params.key?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser()}}},[e._v("确定")]):e._e(),e._v(" "),"modify"==this.$route.params.key?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.modifyUser()}}},[e._v("确定")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.goBack()}}},[e._v("取消")])],1)])])},staticRenderFns:[]};var m=a("VU/8")(r,n,!1,function(e){a("u8f4")},"data-v-40390aa3",null);t.default=m.exports},u8f4:function(e,t){}});
//# sourceMappingURL=8.b57ceef9415de0d1a069.js.map